# **ПЛАН НАГРУЗОЧНОГО ТЕСТИРОВАНИЯ БД САЙТА** #

***ПРЕДУСЛОВИЯ:***
- *Тестируемая система - сайт WordPress, поднятый из Docker-контейнера вместе с базой данных;*
- *Тестирование проводилось на примере процедур ./scripts/dorepeat_v1.sql и ./scripts/dorepeat_v2.sql;*
- *Обе процедуры эмулируют активность пользователей с ролью "Писатель" на сайте;*
- *Нагрузочный профиль для каждой процедурой предполагает их выполнение по 10 раз с интервалом в 1 секунду вплоть до достижения 100 выполнений, запускаютюся эти процедуры одновременно;*
- *Также на сервер подаётся фоновая нагрузка, эмулирующая роль "Читатель" на сайте, дабы испытания были прилближены к "реалистичным условиям" (подробнее см. в ./WP_2_procedure_load_test_plan.jmx);*
- *Проверки проводятся исходя из того предположения, что процедура "dorepeat_v2.sql" будет обрабатываться сервером медленней и с большим процентом ошибок, ибо предполагает большее число операций с БД;*
- *Окружение: ОС - Windows 10 Professional x64; средство нагрузочного тестирования - Apache JMeter 5.5; средство развёртывания БД - DBeaver 23.3.0 (Community Edition); средство контейнеризации - Docker Desktop, Engine v23.0.5;*

## **ПРОВОДИМЫЕ ПРОВЕРКИ:** ##

1) - Параллельный запуск процедур "dorepreat_v1" и "dorepeat_v2";
   - Выполненные действия: запустить параллельно обе процедуры согласно указанному тестовому плану в JMeter в течение 10 сек, затем остановить их выполнение;
   - Ожидаемый результат: "dorepreat_v1" выполняется с меньшим откликом и даёт меньше ошибок, нежели "dorepeat_v2";
   - Фактический результат: соответствует ожидаемому, т.е. проверку можно считать пройденной;
   - Артефакты с результатами проверки: см. директории ./metrics_graphs и ./reports_tables;

# **ОТЧЁТ О НАГРУЗОЧНОМ ТЕСТИРОВАНИИ (на примере процедур "dorepreat_v1" и "dorepeat_v2")** #

В целом, по проведении проверок можно сделать вывод, что версия 1 процедуры является более целесообразной при внедрении в систему, т.к. имеет в целом значительно меньшее время отклика, а также более стабильна в плане процента ошибок.

Об этом говорит, например, общая статистика по процедурам из сводного отчёта:
https://github.com/Gvynhartt/HW_Load-Test-Report-n-Summary/blob/main/report_tables/aggregate.csv

Общий отчёт же уточняет статистику по процентилям: и для 95, и для 99 процентилей скорость версии 1 процедуры практически на порядок выше, при этом даже на такой небольшой выборке видно, что версия 2 даёт на 0.10% ошибок больше.
https://github.com/Gvynhartt/HW_Load-Test-Report-n-Summary/blob/main/report_tables/summary.csv

При этом исходя из характеров графиков можно заключить, что далее разрыв между версиями будет только усугубляться.
Весьма показателен здесь график распределения значений времени отклика по процентилям:
![image](https://github.com/Gvynhartt/HW_Load-Test-Report-n-Summary/assets/122565416/0546921e-0f6a-4a5b-adee-f9e4569afe5d)

Чуть менее плавная, но всё так же показательная тенденция вырисоывается и если взглянуть на графики откликов по тредам:
![image](https://github.com/Gvynhartt/HW_Load-Test-Report-n-Summary/assets/122565416/9a8b5bb9-393e-409d-8c3c-3078f3076538)

Весьма красноречив и разрыв по задержке с течением времени:
![image](https://github.com/Gvynhartt/HW_Load-Test-Report-n-Summary/assets/122565416/0a5eff14-e186-4bc6-8301-6d7ac052ce68)
Хотя здесь тенденция уже не столь однозначна, что может указывавть на необходимость дальнейших расширенных проверок.

**ВОЗМОЖНЫЕ ПОСЛЕДУЮЩИЕ ПРОВЕРКИ**

С учётом картины на последнем графике для более чёткого вердикта представляется разумным провести дальнейшее сличение процедур с иными условиями:

1) В течение более продолжительного времени (допустим, 1 часа);
2) С большим числом эмулируемых пользователей (например, 1000 на каждый тред);
3) Интересно будет взглянуть и на то, какие показатели выдадут процедуры при наличии иных операций в БД, обращающихся к тем же записям, особенно с дополнительной логикой - особенно если, скажем, планируется внедрение сбора каких-либо статистик по содержанию постов пользователей.

Также полезно будет сличить полученные результаты с допустимым пределом задержки по процедурам, когда тот будет согласован с заказчиком.

